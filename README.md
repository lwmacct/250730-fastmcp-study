# FastMCP Study Project - Code Reuse with Shared Components

æœ¬é¡¹ç›®æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `uv` å·¥ä½œç©ºé—´å’Œå…±äº«åº“æ¥æ¶ˆé™¤ FastMCP æœåŠ¡å™¨ä¹‹é—´çš„é‡å¤ä»£ç ã€‚

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### å·¥ä½œç©ºé—´ç»“æ„
```
250730-fastmcp-study/
â”œâ”€â”€ main.py                    # æµ‹è¯•å®¢æˆ·ç«¯
â”œâ”€â”€ pyproject.toml             # æ ¹å·¥ä½œç©ºé—´é…ç½®
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ mcp-shared/           # å…±äº«ç»„ä»¶åº“
â”‚       â”œâ”€â”€ src/mcp_shared/
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ middleware.py  # ä¸­é—´ä»¶ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ tools.py      # å¯å¤ç”¨å·¥å…·
â”‚       â”‚   â””â”€â”€ prompts.py    # æç¤ºæ¨¡æ¿
â”‚       â””â”€â”€ pyproject.toml
â””â”€â”€ servers/
    â”œâ”€â”€ stdio-server/         # STDIO ä¼ è¾“æœåŠ¡å™¨
    â”‚   â”œâ”€â”€ main.py
    â”‚   â””â”€â”€ pyproject.toml
    â””â”€â”€ http-server/          # HTTP ä¼ è¾“æœåŠ¡å™¨
        â”œâ”€â”€ main.py
        â””â”€â”€ pyproject.toml
```

### ğŸ”„ ä»£ç å¤ç”¨è®¾è®¡

#### å…±äº«ç»„ä»¶åº“ (`packages/mcp-shared`)

**1. å…±äº«å·¥å…· (`tools.py`)**
- `create_server_info_tool()` - æœåŠ¡å™¨ä¿¡æ¯å·¥å…·
- `create_math_tool()` - æ•°å­¦è®¡ç®—å·¥å…·
- `create_string_tool()` - å­—ç¬¦ä¸²æ“ä½œå·¥å…·  
- `create_data_generator_tool()` - æ•°æ®ç”Ÿæˆå·¥å…·

**2. å…±äº«æç¤ºæ¨¡æ¿ (`prompts.py`)**
- `create_data_analysis_prompt()` - æ•°æ®åˆ†ææç¤º
- `create_troubleshooting_prompt()` - æ•…éšœæ’é™¤æç¤º
- `create_web_api_prompt()` - Web API æç¤º

**3. ä¸­é—´ä»¶æ”¯æŒ (`middleware.py`)**
- `setup_middleware()` - æ ‡å‡†ä¸­é—´ä»¶è®¾ç½®ï¼ˆä¸ºæœªæ¥æ‰©å±•ä¿ç•™ï¼‰

#### æœåŠ¡å™¨å®ç°

**STDIO æœåŠ¡å™¨ç‰¹æ€§:**
- ä½¿ç”¨æ‰€æœ‰å…±äº«å·¥å…·å’Œæç¤º
- ä¸“ç”¨å·¥å…·ï¼šæ—¶é—´è·å–ã€æ•°å­¦æ“ä½œã€æ–‡æœ¬åˆ†æã€æ•°æ®å¤„ç†ã€å¤šè¯­è¨€é—®å€™
- åŠ¨æ€èµ„æºï¼šæœåŠ¡å™¨çŠ¶æ€ã€ç¤ºä¾‹æ•°æ®ã€ç³»ç»Ÿä¿¡æ¯

**HTTP æœåŠ¡å™¨ç‰¹æ€§:**
- ä½¿ç”¨æ‰€æœ‰å…±äº«å·¥å…·å’Œæç¤º
- ä¸“ç”¨å·¥å…·ï¼šHTTP è¯·æ±‚æ£€æŸ¥ã€å¤©æ°”æ¨¡æ‹Ÿã€æ¶ˆæ¯å›å£°
- HTTP è°ƒè¯•æç¤ºæ¨¡æ¿
- åŠ¨æ€èµ„æºï¼šæœåŠ¡å™¨ä¿¡æ¯ã€ç¤ºä¾‹æ•°æ®ã€å¤©æ°”é¢„æŠ¥

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å®‰è£…ä¾èµ–
```bash
uv sync
```

### æµ‹è¯•æœåŠ¡å™¨

**å¿«é€Ÿæµ‹è¯•:**
```bash
# æµ‹è¯• STDIO æœåŠ¡å™¨
uv run python main.py stdio --quick get_server_info

# æµ‹è¯•å…±äº«æ•°å­¦å·¥å…·
uv run python main.py stdio --quick calculate --params '{"expression": "2+3*4"}'

# æµ‹è¯•å…±äº«å­—ç¬¦ä¸²å·¥å…·
uv run python main.py stdio --quick string_operations --params '{"text": "Hello", "operation": "upper"}'
```

**å®Œæ•´æµ‹è¯•:**
```bash
# è¿è¡Œæ‰€æœ‰ STDIO æµ‹è¯•
uv run python main.py stdio

# è¿è¡Œæ‰€æœ‰ HTTP æµ‹è¯•
uv run python main.py http
```

## ğŸ“Š ä»£ç å¤ç”¨æ•ˆæœ

### æ¶ˆé™¤çš„é‡å¤ä»£ç 
- **ä¸­é—´ä»¶è®¾ç½®** - ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- **æ ¸å¿ƒå·¥å…·** - æ•°å­¦ã€å­—ç¬¦ä¸²ã€æ•°æ®ç”Ÿæˆç­‰é€šç”¨åŠŸèƒ½
- **æç¤ºæ¨¡æ¿** - LLM äº¤äº’çš„ç»“æ„åŒ–æ¨¡æ¿
- **Context æ³¨å…¥** - æ ‡å‡†åŒ–çš„ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ—¥å¿—è®°å½•

### æ¶æ„ä¼˜åŠ¿
1. **DRY åŸåˆ™** - ä¸é‡å¤ä»£ç ï¼Œå•ä¸€æ•°æ®æº
2. **æ˜“ç»´æŠ¤æ€§** - å…±äº«ç»„ä»¶çš„ä¿®æ”¹è‡ªåŠ¨å½±å“æ‰€æœ‰æœåŠ¡å™¨
3. **ä¸€è‡´æ€§** - æ‰€æœ‰æœåŠ¡å™¨ä½¿ç”¨ç›¸åŒçš„å·¥å…·è¡Œä¸º
4. **å¯æ‰©å±•æ€§** - æ–°æœåŠ¡å™¨å¯è½»æ¾é‡ç”¨ç°æœ‰ç»„ä»¶

### å·¥ä½œç©ºé—´é…ç½® (`pyproject.toml`)
```toml
[tool.uv.workspace]
members = [
    "servers/stdio-server",
    "servers/http-server", 
    "packages/mcp-shared",
]
```

æœåŠ¡å™¨é€šè¿‡ä»¥ä¸‹æ–¹å¼å¼•ç”¨å…±äº«åº“:
```toml
dependencies = ["mcp-shared"]

[tool.uv.sources]
mcp-shared = { workspace = true }
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **uv** - Python åŒ…ç®¡ç†å’Œå·¥ä½œç©ºé—´
- **FastMCP 2.10.6** - MCP æœåŠ¡å™¨æ¡†æ¶
- **å·¥ä½œç©ºé—´æˆå‘˜** - stdio-server, http-server, mcp-shared
- **ä¼ è¾“åè®®** - STDIO, Streamable HTTP

## ğŸ“ˆ æµ‹è¯•çŠ¶æ€

âœ… **STDIO æœåŠ¡å™¨** - å®Œå…¨å·¥ä½œï¼Œæ‰€æœ‰å·¥å…·å’Œèµ„æºæ­£å¸¸  
âš ï¸ **HTTP æœåŠ¡å™¨** - å…±äº«ç»„ä»¶å·¥ä½œï¼ŒHTTP ç‰¹å®šåŠŸèƒ½éœ€è¦è¿›ä¸€æ­¥è°ƒè¯•  
âœ… **å…±äº«åº“** - æˆåŠŸæ¶ˆé™¤ä»£ç é‡å¤ï¼Œæ‰€æœ‰å·¥å…·æ­£å¸¸è¿è¡Œ

è¿™ä¸ªæ¶æ„æ¼”ç¤ºäº†å¦‚ä½•åœ¨ FastMCP é¡¹ç›®ä¸­æœ‰æ•ˆå®ç°ä»£ç å¤ç”¨ï¼Œå¤§å¤§å‡å°‘äº†ç»´æŠ¤æˆæœ¬å¹¶æé«˜äº†ä»£ç è´¨é‡ã€‚
